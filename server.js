const express = require('express');
const http = require('http');
const { Server } = require('socket.io');

const app = express();
const server = http.createServer(app);
const io = new Server(server);

app.use(express.static('public')); // Ð’Ñ–Ð´Ð´Ð°Ñ” index.html

// Ð´Ð°Ð½Ñ–
const fuelStats = {
  '395454021343': {
    name: 'Ð†Ð²Ð°Ð½ ÐŸÐµÑ‚Ñ€ÐµÐ½ÐºÐ¾',
    result: 'ÐŸÐµÑ€ÐµÐ²Ð¸Ñ‚Ñ€Ð°Ñ‚Ð°: 12.4 Ð». Ð¨Ñ‚Ñ€Ð°Ñ„: 744 Ð³Ñ€Ð½.'
  },
  '284920137652': {
    name: 'ÐžÐ»ÐµÐ³ ÐšÐ¾Ð²Ð°Ð»ÐµÐ½ÐºÐ¾',
    result: 'Ð•ÐºÐ¾Ð½Ð¾Ð¼Ñ–Ñ: 6.2 Ð». ÐœÐ¾Ð»Ð¾Ð´ÐµÑ†ÑŒ!'
  },
  '509283746198': {
    name: 'ÐœÐ°Ñ€Ð¸Ð½Ð° Ð”ÑÑ‡ÐµÐ½ÐºÐ¾',
    result: 'ÐŸÐµÑ€ÐµÐ²Ð¸Ñ‚Ñ€Ð°Ñ‚Ð°: 9.1 Ð». Ð¨Ñ‚Ñ€Ð°Ñ„: 546 Ð³Ñ€Ð½.'
  },
  '143829405671': {
    name: 'ÐÐ½Ð´Ñ€Ñ–Ð¹ Ð¨ÐµÐ²Ñ‡ÑƒÐº',
    result: 'Ð•ÐºÐ¾Ð½Ð¾Ð¼Ñ–Ñ: 3.7 Ð». Ð”Ð¾Ð±Ñ€Ð° Ñ€Ð¾Ð±Ð¾Ñ‚Ð°!'
  },
  '837261594028': {
    name: 'Ð®Ñ€Ñ–Ð¹ ÐœÐµÐ»ÑŒÐ½Ð¸Ðº',
    result: 'ÐŸÐµÑ€ÐµÐ²Ð¸Ñ‚Ñ€Ð°Ñ‚Ð°: 14.0 Ð». Ð¨Ñ‚Ñ€Ð°Ñ„: 840 Ð³Ñ€Ð½.'
  },
  '720193847560': {
    name: 'Ð¡ÐµÑ€Ð³Ñ–Ð¹ Ð‘Ð¾Ð½Ð´Ð°Ñ€',
    result: 'Ð•ÐºÐ¾Ð½Ð¾Ð¼Ñ–Ñ: 1.8 Ð». Ð’ Ð¼ÐµÐ¶Ð°Ñ… Ð½Ð¾Ñ€Ð¼Ð¸.'
  },
  '690127485390': {
    name: 'Ð¢ÐµÑ‚ÑÐ½Ð° Ð†Ð²Ð°Ð½Ð¾Ð²Ð°',
    result: 'ÐŸÐµÑ€ÐµÐ²Ð¸Ñ‚Ñ€Ð°Ñ‚Ð°: 5.6 Ð». Ð¨Ñ‚Ñ€Ð°Ñ„: 336 Ð³Ñ€Ð½.'
  },
  '319847206598': {
    name: 'ÐŸÐ°Ð²Ð»Ð¾ Ð“Ð¾Ð½Ñ‡Ð°Ñ€',
    result: 'Ð•ÐºÐ¾Ð½Ð¾Ð¼Ñ–Ñ: 7.4 Ð». Ð’Ñ–Ð´Ð¼Ñ–Ð½Ð½Ð¾!'
  },
  '491028374561': {
    name: 'Ð›ÑŽÐ´Ð¼Ð¸Ð»Ð° Ð¡Ð°Ð²Ñ‡ÑƒÐº',
    result: 'ÐŸÐµÑ€ÐµÐ²Ð¸Ñ‚Ñ€Ð°Ñ‚Ð°: 11.2 Ð». Ð¨Ñ‚Ñ€Ð°Ñ„: 672 Ð³Ñ€Ð½.'
  },
  '258390174602': {
    name: 'ÐžÐ»ÐµÐ½Ð° ÐœÐ°Ñ€Ñ‡ÐµÐ½ÐºÐ¾',
    result: 'Ð•ÐºÐ¾Ð½Ð¾Ð¼Ñ–Ñ: 4.5 Ð». ÐÐ¾Ñ€Ð¼Ð° Ð½Ðµ Ð¿ÐµÑ€ÐµÐ²Ð¸Ñ‰ÐµÐ½Ð°.'
  }
};

// ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° WebSocket-Ð·â€™Ñ”Ð´Ð½Ð°Ð½Ð½Ñ
io.on('connection', (socket) => {
  console.log('ÐšÐ»Ñ–Ñ”Ð½Ñ‚ Ð¿Ñ–Ð´ÐºÐ»ÑŽÑ‡Ð¸Ð²ÑÑ');

  socket.on('driver ipn', (ipn) => {
    const data = fuelStats[ipn];
    if (data) {
      const message = `ðŸ‘¤ ${data.name}\nðŸ“Š ${data.result}`;
      socket.emit('fuel result', message);
    } else {
      socket.emit('fuel result', 'ÐÐµÐ²Ñ–Ð´Ð¾Ð¼Ð¸Ð¹ Ð†ÐŸÐ. Ð”Ð°Ð½Ñ– Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ñ–.');
    }
  });
});

server.listen(3000, () => {
  console.log('Ð¡ÐµÑ€Ð²ÐµÑ€ Ð¿Ñ€Ð°Ñ†ÑŽÑ” Ð½Ð° http://localhost:3000');
});
